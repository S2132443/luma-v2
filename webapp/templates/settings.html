{% extends "base.html" %}

{% block title %}Settings - Luma Bot{% endblock %}

{% block content %}
<h1>Settings</h1>

{% if success %}
<div class="success-message">
    Settings saved successfully! The bot will use the new personality immediately.
</div>
{% endif %}

<form method="post">
    <label for="model_provider">Model Provider:</label>
    <select id="model_provider" name="model_provider">
        <option value="deepseek" {% if model_provider == 'deepseek' %}selected{% endif %}>DeepSeek API</option>
        <option value="ollama" {% if model_provider == 'ollama' %}selected{% endif %}>Ollama (Local)</option>
    </select>

    <div id="deepseek_section" style="display: {% if model_provider == 'deepseek' %}block{% else %}none{% endif %};">
        <label for="deepseek_api_key">DeepSeek API Key:</label>
        <input type="password" id="deepseek_api_key" name="deepseek_api_key" value="{{ deepseek_key }}" placeholder="sk-...">
    </div>

    <div id="ollama_section" style="display: {% if model_provider == 'ollama' %}block{% else %}none{% endif %};">
        <label for="ollama_endpoint">Ollama Endpoint:</label>
        <input type="text" id="ollama_endpoint" name="ollama_endpoint" value="{{ ollama_endpoint }}" placeholder="http://localhost:11434">

        <label for="ollama_model">Ollama Model:</label>
        <input type="text" id="ollama_model" name="ollama_model" value="{{ ollama_model }}" placeholder="llama2">
    </div>

    <label for="discord_token">Discord Token:</label>
    <input type="password" id="discord_token" name="discord_token" value="{{ discord_token }}" placeholder="Your Discord bot token">

    <label for="personality">Bot Personality:</label>
    <textarea id="personality" name="personality" placeholder="Define how your bot should behave...">{{ personality }}</textarea>

    <label for="memory_suggestions_enabled">AI Memory Suggestions:</label>
    <select id="memory_suggestions_enabled" name="memory_suggestions_enabled">
        <option value="false" {% if memory_suggestions_enabled == 'false' or memory_suggestions_enabled == False %}selected{% endif %}>Disabled (Default)</option>
        <option value="true" {% if memory_suggestions_enabled == 'true' %}selected{% endif %}>Enabled</option>
    </select>

    <input type="submit" value="Save Settings">
</form>

<script>
document.getElementById('model_provider').addEventListener('change', function() {
    const deepseekSection = document.getElementById('deepseek_section');
    const ollamaSection = document.getElementById('ollama_section');

    if (this.value === 'deepseek') {
        deepseekSection.style.display = 'block';
        ollamaSection.style.display = 'none';
    } else if (this.value === 'ollama') {
        deepseekSection.style.display = 'none';
        ollamaSection.style.display = 'block';
    }
});
</script>
{% endblock %}
